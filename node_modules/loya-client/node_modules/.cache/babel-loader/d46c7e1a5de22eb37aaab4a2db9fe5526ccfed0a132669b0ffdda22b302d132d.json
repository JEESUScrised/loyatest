{"ast":null,"code":"import{useState,useEffect}from'react';// Типы для Telegram WebApp API\nexport const useTelegram=()=>{var _window$Telegram2;const[webApp,setWebApp]=useState(null);const[user,setUser]=useState(null);const[isReady,setIsReady]=useState(false);useEffect(()=>{var _window$Telegram;// Проверяем, что мы в Telegram WebApp\nif((_window$Telegram=window.Telegram)!==null&&_window$Telegram!==void 0&&_window$Telegram.WebApp){const tg=window.Telegram.WebApp;// Инициализируем WebApp\ntg.ready();tg.expand();setWebApp(tg);setUser(tg.initDataUnsafe.user||null);setIsReady(true);// Настраиваем тему\ndocument.body.style.backgroundColor=tg.backgroundColor;document.body.style.color=tg.themeParams.text_color||'#000000';// Обработчик закрытия приложения\nconst handleClose=()=>{tg.close();};// Добавляем обработчик\ntg.onEvent('backButtonClicked',handleClose);return()=>{tg.offEvent('backButtonClicked',handleClose);};}else{// Для разработки - создаем мок данные\nconst mockUser={id:123456789,first_name:'Test',last_name:'User',username:'testuser',language_code:'ru'};setUser(mockUser);setIsReady(true);}},[]);// Получение данных пользователя для регистрации\nconst getTelegramData=()=>{if(user){return{id:user.id,first_name:user.first_name,last_name:user.last_name||'',username:user.username||''};}return null;};// Показать главную кнопку\nconst showMainButton=(text,onClick)=>{if(webApp){webApp.MainButton.setText(text);webApp.MainButton.onClick(onClick);webApp.MainButton.show();}};// Скрыть главную кнопку\nconst hideMainButton=()=>{if(webApp){webApp.MainButton.hide();}};// Показать кнопку \"Назад\"\nconst showBackButton=onClick=>{if(webApp){webApp.BackButton.onClick(onClick);webApp.BackButton.show();}};// Скрыть кнопку \"Назад\"\nconst hideBackButton=()=>{if(webApp){webApp.BackButton.hide();}};// Тактильная обратная связь\nconst hapticFeedback={impact:function(){let style=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'medium';if(webApp){webApp.HapticFeedback.impactOccurred(style);}},notification:type=>{if(webApp){webApp.HapticFeedback.notificationOccurred(type);}},selection:()=>{if(webApp){webApp.HapticFeedback.selectionChanged();}}};// Закрыть приложение\nconst closeApp=()=>{if(webApp){webApp.close();}};return{webApp,user,isReady,isTelegram:!!((_window$Telegram2=window.Telegram)!==null&&_window$Telegram2!==void 0&&_window$Telegram2.WebApp),getTelegramData,showMainButton,hideMainButton,showBackButton,hideBackButton,hapticFeedback,closeApp,theme:(webApp===null||webApp===void 0?void 0:webApp.themeParams)||{},colorScheme:(webApp===null||webApp===void 0?void 0:webApp.colorScheme)||'light'};};","map":{"version":3,"names":["useState","useEffect","useTelegram","_window$Telegram2","webApp","setWebApp","user","setUser","isReady","setIsReady","_window$Telegram","window","Telegram","WebApp","tg","ready","expand","initDataUnsafe","document","body","style","backgroundColor","color","themeParams","text_color","handleClose","close","onEvent","offEvent","mockUser","id","first_name","last_name","username","language_code","getTelegramData","showMainButton","text","onClick","MainButton","setText","show","hideMainButton","hide","showBackButton","BackButton","hideBackButton","hapticFeedback","impact","arguments","length","undefined","HapticFeedback","impactOccurred","notification","type","notificationOccurred","selection","selectionChanged","closeApp","isTelegram","theme","colorScheme"],"sources":["C:/Users/admnp/Desktop/Loya/frontends/client/src/hooks/useTelegram.ts"],"sourcesContent":["import { useState, useEffect } from 'react';\n\n// Типы для Telegram WebApp API\ninterface TelegramWebApp {\n  initData: string;\n  initDataUnsafe: {\n    user?: {\n      id: number;\n      first_name: string;\n      last_name?: string;\n      username?: string;\n      language_code?: string;\n    };\n    auth_date: number;\n    hash: string;\n  };\n  version: string;\n  platform: string;\n  colorScheme: 'light' | 'dark';\n  themeParams: {\n    bg_color?: string;\n    text_color?: string;\n    hint_color?: string;\n    link_color?: string;\n    button_color?: string;\n    button_text_color?: string;\n  };\n  isExpanded: boolean;\n  viewportHeight: number;\n  viewportStableHeight: number;\n  headerColor: string;\n  backgroundColor: string;\n  isClosingConfirmationEnabled: boolean;\n  BackButton: {\n    isVisible: boolean;\n    onClick: (callback: () => void) => void;\n    offClick: (callback: () => void) => void;\n    show: () => void;\n    hide: () => void;\n  };\n  MainButton: {\n    text: string;\n    color: string;\n    textColor: string;\n    isVisible: boolean;\n    isActive: boolean;\n    isProgressVisible: boolean;\n    setText: (text: string) => void;\n    onClick: (callback: () => void) => void;\n    offClick: (callback: () => void) => void;\n    show: () => void;\n    hide: () => void;\n    enable: () => void;\n    disable: () => void;\n    showProgress: (leaveActive?: boolean) => void;\n    hideProgress: () => void;\n    setParams: (params: {\n      text?: string;\n      color?: string;\n      text_color?: string;\n      is_active?: boolean;\n      is_visible?: boolean;\n    }) => void;\n  };\n  HapticFeedback: {\n    impactOccurred: (style: 'light' | 'medium' | 'heavy' | 'rigid' | 'soft') => void;\n    notificationOccurred: (type: 'error' | 'success' | 'warning') => void;\n    selectionChanged: () => void;\n  };\n  ready: () => void;\n  expand: () => void;\n  close: () => void;\n  onEvent: (eventType: string, eventHandler: () => void) => void;\n  offEvent: (eventType: string, eventHandler: () => void) => void;\n}\n\ndeclare global {\n  interface Window {\n    Telegram?: {\n      WebApp: TelegramWebApp;\n    };\n  }\n}\n\nexport const useTelegram = () => {\n  const [webApp, setWebApp] = useState<TelegramWebApp | null>(null);\n  const [user, setUser] = useState<TelegramWebApp['initDataUnsafe']['user'] | null>(null);\n  const [isReady, setIsReady] = useState(false);\n\n  useEffect(() => {\n    // Проверяем, что мы в Telegram WebApp\n    if (window.Telegram?.WebApp) {\n      const tg = window.Telegram.WebApp;\n      \n      // Инициализируем WebApp\n      tg.ready();\n      tg.expand();\n      \n      setWebApp(tg);\n      setUser(tg.initDataUnsafe.user || null);\n      setIsReady(true);\n\n      // Настраиваем тему\n      document.body.style.backgroundColor = tg.backgroundColor;\n      document.body.style.color = tg.themeParams.text_color || '#000000';\n\n      // Обработчик закрытия приложения\n      const handleClose = () => {\n        tg.close();\n      };\n\n      // Добавляем обработчик\n      tg.onEvent('backButtonClicked', handleClose);\n\n      return () => {\n        tg.offEvent('backButtonClicked', handleClose);\n      };\n    } else {\n      // Для разработки - создаем мок данные\n      const mockUser = {\n        id: 123456789,\n        first_name: 'Test',\n        last_name: 'User',\n        username: 'testuser',\n        language_code: 'ru'\n      };\n      \n      setUser(mockUser);\n      setIsReady(true);\n    }\n  }, []);\n\n  // Получение данных пользователя для регистрации\n  const getTelegramData = () => {\n    if (user) {\n      return {\n        id: user.id,\n        first_name: user.first_name,\n        last_name: user.last_name || '',\n        username: user.username || ''\n      };\n    }\n    return null;\n  };\n\n  // Показать главную кнопку\n  const showMainButton = (text: string, onClick: () => void) => {\n    if (webApp) {\n      webApp.MainButton.setText(text);\n      webApp.MainButton.onClick(onClick);\n      webApp.MainButton.show();\n    }\n  };\n\n  // Скрыть главную кнопку\n  const hideMainButton = () => {\n    if (webApp) {\n      webApp.MainButton.hide();\n    }\n  };\n\n  // Показать кнопку \"Назад\"\n  const showBackButton = (onClick: () => void) => {\n    if (webApp) {\n      webApp.BackButton.onClick(onClick);\n      webApp.BackButton.show();\n    }\n  };\n\n  // Скрыть кнопку \"Назад\"\n  const hideBackButton = () => {\n    if (webApp) {\n      webApp.BackButton.hide();\n    }\n  };\n\n  // Тактильная обратная связь\n  const hapticFeedback = {\n    impact: (style: 'light' | 'medium' | 'heavy' | 'rigid' | 'soft' = 'medium') => {\n      if (webApp) {\n        webApp.HapticFeedback.impactOccurred(style);\n      }\n    },\n    notification: (type: 'error' | 'success' | 'warning') => {\n      if (webApp) {\n        webApp.HapticFeedback.notificationOccurred(type);\n      }\n    },\n    selection: () => {\n      if (webApp) {\n        webApp.HapticFeedback.selectionChanged();\n      }\n    }\n  };\n\n  // Закрыть приложение\n  const closeApp = () => {\n    if (webApp) {\n      webApp.close();\n    }\n  };\n\n  return {\n    webApp,\n    user,\n    isReady,\n    isTelegram: !!window.Telegram?.WebApp,\n    getTelegramData,\n    showMainButton,\n    hideMainButton,\n    showBackButton,\n    hideBackButton,\n    hapticFeedback,\n    closeApp,\n    theme: webApp?.themeParams || {},\n    colorScheme: webApp?.colorScheme || 'light'\n  };\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}