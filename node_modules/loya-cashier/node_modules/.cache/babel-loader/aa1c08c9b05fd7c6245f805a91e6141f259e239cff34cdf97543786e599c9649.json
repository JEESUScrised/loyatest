{"ast":null,"code":"import axios from 'axios';\nclass ApiClient {\n  constructor() {\n    this.instance = void 0;\n    this.authToken = null;\n    // Определяем базовый URL API\n    const baseURL = process.env.REACT_APP_API_URL || 'http://localhost:5000/api';\n    this.instance = axios.create({\n      baseURL,\n      timeout: 30000,\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    });\n\n    // Interceptor для добавления токена авторизации\n    this.instance.interceptors.request.use(config => {\n      if (this.authToken) {\n        config.headers.Authorization = `Bearer ${this.authToken}`;\n      }\n      return config;\n    }, error => {\n      return Promise.reject(error);\n    });\n\n    // Interceptor для обработки ответов\n    this.instance.interceptors.response.use(response => {\n      return response;\n    }, error => {\n      var _error$response;\n      if (((_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status) === 401) {\n        // Токен истек или невалиден\n        this.removeAuthToken();\n        window.location.href = '/login';\n      }\n      return Promise.reject(error);\n    });\n  }\n\n  // Установить токен авторизации\n  setAuthToken(token) {\n    this.authToken = token;\n    localStorage.setItem('auth_token', token);\n  }\n\n  // Удалить токен авторизации\n  removeAuthToken() {\n    this.authToken = null;\n    localStorage.removeItem('auth_token');\n  }\n\n  // Проверить наличие токена\n  getAuthToken() {\n    if (!this.authToken) {\n      this.authToken = localStorage.getItem('auth_token');\n    }\n    return this.authToken;\n  }\n\n  // GET запрос\n  async get(url, config) {\n    try {\n      const response = await this.instance.get(url, config);\n      return {\n        success: true,\n        data: response.data.data,\n        message: response.data.message\n      };\n    } catch (error) {\n      var _error$response2, _error$response2$data, _error$response3, _error$response3$data;\n      return {\n        success: false,\n        error: ((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : (_error$response2$data = _error$response2.data) === null || _error$response2$data === void 0 ? void 0 : _error$response2$data.message) || error.message || 'Ошибка при выполнении запроса',\n        message: ((_error$response3 = error.response) === null || _error$response3 === void 0 ? void 0 : (_error$response3$data = _error$response3.data) === null || _error$response3$data === void 0 ? void 0 : _error$response3$data.message) || error.message || 'Ошибка при выполнении запроса'\n      };\n    }\n  }\n\n  // POST запрос\n  async post(url, data, config) {\n    try {\n      const response = await this.instance.post(url, data, config);\n      return {\n        success: true,\n        data: response.data.data || response.data,\n        message: response.data.message\n      };\n    } catch (error) {\n      var _error$response4, _error$response4$data, _error$response5, _error$response5$data;\n      return {\n        success: false,\n        error: ((_error$response4 = error.response) === null || _error$response4 === void 0 ? void 0 : (_error$response4$data = _error$response4.data) === null || _error$response4$data === void 0 ? void 0 : _error$response4$data.message) || error.message || 'Ошибка при выполнении запроса',\n        message: ((_error$response5 = error.response) === null || _error$response5 === void 0 ? void 0 : (_error$response5$data = _error$response5.data) === null || _error$response5$data === void 0 ? void 0 : _error$response5$data.message) || error.message || 'Ошибка при выполнении запроса'\n      };\n    }\n  }\n\n  // PUT запрос\n  async put(url, data, config) {\n    try {\n      const response = await this.instance.put(url, data, config);\n      return {\n        success: true,\n        data: response.data.data,\n        message: response.data.message\n      };\n    } catch (error) {\n      var _error$response6, _error$response6$data, _error$response7, _error$response7$data;\n      return {\n        success: false,\n        error: ((_error$response6 = error.response) === null || _error$response6 === void 0 ? void 0 : (_error$response6$data = _error$response6.data) === null || _error$response6$data === void 0 ? void 0 : _error$response6$data.message) || error.message || 'Ошибка при выполнении запроса',\n        message: ((_error$response7 = error.response) === null || _error$response7 === void 0 ? void 0 : (_error$response7$data = _error$response7.data) === null || _error$response7$data === void 0 ? void 0 : _error$response7$data.message) || error.message || 'Ошибка при выполнении запроса'\n      };\n    }\n  }\n\n  // DELETE запрос\n  async delete(url, config) {\n    try {\n      const response = await this.instance.delete(url, config);\n      return {\n        success: true,\n        data: response.data.data,\n        message: response.data.message\n      };\n    } catch (error) {\n      var _error$response8, _error$response8$data, _error$response9, _error$response9$data;\n      return {\n        success: false,\n        error: ((_error$response8 = error.response) === null || _error$response8 === void 0 ? void 0 : (_error$response8$data = _error$response8.data) === null || _error$response8$data === void 0 ? void 0 : _error$response8$data.message) || error.message || 'Ошибка при выполнении запроса',\n        message: ((_error$response9 = error.response) === null || _error$response9 === void 0 ? void 0 : (_error$response9$data = _error$response9.data) === null || _error$response9$data === void 0 ? void 0 : _error$response9$data.message) || error.message || 'Ошибка при выполнении запроса'\n      };\n    }\n  }\n}\nexport const apiClient = new ApiClient();","map":{"version":3,"names":["axios","ApiClient","constructor","instance","authToken","baseURL","process","env","REACT_APP_API_URL","create","timeout","headers","interceptors","request","use","config","Authorization","error","Promise","reject","response","_error$response","status","removeAuthToken","window","location","href","setAuthToken","token","localStorage","setItem","removeItem","getAuthToken","getItem","get","url","success","data","message","_error$response2","_error$response2$data","_error$response3","_error$response3$data","post","_error$response4","_error$response4$data","_error$response5","_error$response5$data","put","_error$response6","_error$response6$data","_error$response7","_error$response7$data","delete","_error$response8","_error$response8$data","_error$response9","_error$response9$data","apiClient"],"sources":["C:/Users/admnp/Desktop/Loya/frontends/cashier/src/services/apiClient.ts"],"sourcesContent":["import axios, { AxiosInstance, AxiosRequestConfig, AxiosResponse } from 'axios';\r\n\r\nexport interface ApiResponse<T = any> {\r\n  success: boolean;\r\n  message?: string;\r\n  data?: T;\r\n  error?: string;\r\n}\r\n\r\nclass ApiClient {\r\n  private instance: AxiosInstance;\r\n  private authToken: string | null = null;\r\n\r\n  constructor() {\r\n    // Определяем базовый URL API\r\n    const baseURL = process.env.REACT_APP_API_URL || 'http://localhost:5000/api';\r\n    \r\n    this.instance = axios.create({\r\n      baseURL,\r\n      timeout: 30000,\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n    });\r\n\r\n    // Interceptor для добавления токена авторизации\r\n    this.instance.interceptors.request.use(\r\n      (config) => {\r\n        if (this.authToken) {\r\n          config.headers.Authorization = `Bearer ${this.authToken}`;\r\n        }\r\n        return config;\r\n      },\r\n      (error) => {\r\n        return Promise.reject(error);\r\n      }\r\n    );\r\n\r\n    // Interceptor для обработки ответов\r\n    this.instance.interceptors.response.use(\r\n      (response: AxiosResponse) => {\r\n        return response;\r\n      },\r\n      (error) => {\r\n        if (error.response?.status === 401) {\r\n          // Токен истек или невалиден\r\n          this.removeAuthToken();\r\n          window.location.href = '/login';\r\n        }\r\n        return Promise.reject(error);\r\n      }\r\n    );\r\n  }\r\n\r\n  // Установить токен авторизации\r\n  public setAuthToken(token: string): void {\r\n    this.authToken = token;\r\n    localStorage.setItem('auth_token', token);\r\n  }\r\n\r\n  // Удалить токен авторизации\r\n  public removeAuthToken(): void {\r\n    this.authToken = null;\r\n    localStorage.removeItem('auth_token');\r\n  }\r\n\r\n  // Проверить наличие токена\r\n  public getAuthToken(): string | null {\r\n    if (!this.authToken) {\r\n      this.authToken = localStorage.getItem('auth_token');\r\n    }\r\n    return this.authToken;\r\n  }\r\n\r\n  // GET запрос\r\n  public async get<T = any>(url: string, config?: AxiosRequestConfig): Promise<ApiResponse<T>> {\r\n    try {\r\n      const response = await this.instance.get(url, config);\r\n      return {\r\n        success: true,\r\n        data: response.data.data,\r\n        message: response.data.message,\r\n      };\r\n    } catch (error: any) {\r\n      return {\r\n        success: false,\r\n        error: error.response?.data?.message || error.message || 'Ошибка при выполнении запроса',\r\n        message: error.response?.data?.message || error.message || 'Ошибка при выполнении запроса',\r\n      };\r\n    }\r\n  }\r\n\r\n  // POST запрос\r\n  public async post<T = any>(url: string, data?: any, config?: AxiosRequestConfig): Promise<ApiResponse<T>> {\r\n    try {\r\n      const response = await this.instance.post(url, data, config);\r\n      return {\r\n        success: true,\r\n        data: response.data.data || response.data,\r\n        message: response.data.message,\r\n      };\r\n    } catch (error: any) {\r\n      return {\r\n        success: false,\r\n        error: error.response?.data?.message || error.message || 'Ошибка при выполнении запроса',\r\n        message: error.response?.data?.message || error.message || 'Ошибка при выполнении запроса',\r\n      };\r\n    }\r\n  }\r\n\r\n  // PUT запрос\r\n  public async put<T = any>(url: string, data?: any, config?: AxiosRequestConfig): Promise<ApiResponse<T>> {\r\n    try {\r\n      const response = await this.instance.put(url, data, config);\r\n      return {\r\n        success: true,\r\n        data: response.data.data,\r\n        message: response.data.message,\r\n      };\r\n    } catch (error: any) {\r\n      return {\r\n        success: false,\r\n        error: error.response?.data?.message || error.message || 'Ошибка при выполнении запроса',\r\n        message: error.response?.data?.message || error.message || 'Ошибка при выполнении запроса',\r\n      };\r\n    }\r\n  }\r\n\r\n  // DELETE запрос\r\n  public async delete<T = any>(url: string, config?: AxiosRequestConfig): Promise<ApiResponse<T>> {\r\n    try {\r\n      const response = await this.instance.delete(url, config);\r\n      return {\r\n        success: true,\r\n        data: response.data.data,\r\n        message: response.data.message,\r\n      };\r\n    } catch (error: any) {\r\n      return {\r\n        success: false,\r\n        error: error.response?.data?.message || error.message || 'Ошибка при выполнении запроса',\r\n        message: error.response?.data?.message || error.message || 'Ошибка при выполнении запроса',\r\n      };\r\n    }\r\n  }\r\n}\r\n\r\nexport const apiClient = new ApiClient();\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}